(function(){var f=0,g=1,h=5000,i=0,j=600,k=!0,l=2,m=300,n=null,o=!1,p=5,q=[],r=[],s=document.getElementById("container-app-1"),t=document.getElementById("history"),u=document.getElementById("lanes"),v=document.getElementById("message"),w=document.getElementById("selectors"),x=document.getElementById("wallet"),y=document.getElementById("btn-reset-history"),z=document.getElementById("btn-reset"),A=document.getElementById("btn-start"),B=s?s.getElementsByClassName("track"):[];if(!s||!u||!v||!x||!w||!t||!z||!y||!A){alert("Some UI elements are missing. Game cannot load.");return}var C=[{id:200,color:"#000000",dark:!0,name:"black"},{id:100,color:"#0000ff",dark:!0,name:"blue"},{id:50,color:"#ff0000",dark:!1,name:"red"},{id:20,color:"#ff00ff",dark:!1,name:"magenta"},{id:10,color:"#00ff00",dark:!1,name:"green"},{id:5,color:"#00ffff",dark:!1,name:"cyan"},{id:2,color:"#ffff00",dark:!1,name:"yellow"},{id:1,color:"#d8d8d8",dark:!1,name:"white"}],D={},E={getItem:function(a){try{return window.localStorage.getItem(a)}catch(b){return D[a]||null}},setItem:function(a,b){try{window.localStorage.setItem(a,b)}catch(c){D[a]=b}},removeItem:function(a){try{window.localStorage.removeItem(a)}catch(b){delete D[a]}}};function F(){var a=[.01,.02,.05,.1,.2,.5,1,2],b=Math.floor(Math.random()*a.length);return a[b]}function G(a){return Math.floor(Math.random()*a)}function H(a){var b=E.getItem("history"),c=b?b+","+a:a;E.setItem("history",c);I()}function I(){var a=E.getItem("history");if(a){y.removeAttribute("disabled");for(var b=a.split(","),c={},d=0;d<b.length;d++){var e=b[d];c[e]=(c[e]||0)+1}t.innerHTML="<pre>"+JSON.stringify(c,null,2)+"</pre>"}else{y.setAttribute("disabled","disabled");t.innerHTML="<p>No Race History As Yet</p>"}}function J(){A.addEventListener("click",Q,!1);z.addEventListener("click",P,!1);y.addEventListener("click",K,!1)}function L(){for(var a=0;a<r.length;a++)r[a].addEventListener("click",M,!1)}function N(){if(!o)return;for(var a=-1,b=0;b<q.length;b++){var c=q[b],d=c.offsetWidth,e=l,f=Math.floor(d+e*F());d<m?c.style.width=f+"px":a===-1&&(a=b)}e++;if(a>-1){if(k){for(b=0;b<r.length;b++)r[b].classList.remove("winner","loser"),r[b].disabled=!1;clearTimeout(j)}var g=q[a],h=g.getElementsByTagName("span")[0].innerHTML,i=g.getAttribute("id");o=!1;O(i,i,h);H(i)}else window.requestAnimationFrame(N)}function S(){for(var a=0;a<r.length;a++)r[a].disabled=!0;A.removeAttribute("disabled")}function T(){for(var a=0;a<r.length;a++)r[a].classList.remove("active","winner","loser"),r[a].disabled=!1;A.setAttribute("disabled","disabled");z.setAttribute("disabled","disabled");w.classList.remove("disabled")}function U(){f=0;for(var a=0;a<q.length;a++)q[a].style.width=l+"px",q[a].classList.remove("active")}function K(){var a="Are You Sure? This Action Will Delete All Race History.";confirm(a)&&(E.removeItem("history"),I())}function O(a,b,c){var d="<p>Resetting Race in "+p+" seconds.</p>",e="Hooray <strong class='upper'>"+c+"</strong> is the Winner! You Won <strong>"+b+"</strong> Credits.</p>"+d,f="<strong class='upper'>"+c+"</strong> is the Winner! You Lose <strong>"+b+"</strong> Credits.</p>"+d;a===b?(v.innerHTML=e,V(b)):(v.innerHTML=f,V(-b));W(a);z.removeAttribute("disabled");n&&clearTimeout(n);n=setTimeout(P,1e3*p)}function M(a){if(o){alert("No Bets Please! Race in Progress.");return}z.removeAttribute("disabled");if(f<g){var b=document.getElementById(this.name);b.classList.add("active");i=b.getAttribute("id");S();this.classList.add("active");f++}else alert("Only 1 Bet Per Race! Select Reset to Choose Again.")}function P(){if(o=!1,n&&clearTimeout(n),v.innerHTML="",parseInt(x.value,10)>0)T(),U();else alert("Funds Required to Reset Race! Refresh Page to Start Again.")}function Q(){o=!0;m=B[0].clientWidth;q=s.querySelectorAll(".lane");window.requestAnimationFrame(N);v.innerHTML="No Bets Please! Race in Progress.";A.setAttribute("disabled","disabled");z.setAttribute("disabled","disabled");w.classList.add("disabled");k&&(j=setInterval(R,j))}function R(){var a=G(r.length),b=G(r.length);r[a].classList.add("loser");r[a].classList.remove("winner");r[b].classList.add("winner");r[b].classList.remove("loser")}function X(){for(var a="",b="",c=0;c<C.length;c++){var d=C[c],e=d.dark?"dark":"";a+='<div style="background-color: '+d.color+'" id="'+d.id+'" class="lane '+e+'"><span>'+d.name+"</span></div>";b+='<button style="background-color: '+d.color+'" name="'+d.id+'" class="btn-selector '+e+'">'+d.id+"<sup>c</sup></button>"}u.innerHTML=a;w.innerHTML=b;q=s.querySelectorAll(".lane");r=s.querySelectorAll(".btn-selector");L()}function W(a){for(var b=0;b<r.length;b++)r[b].name===a?r[b].classList.add("winner"):r[b].classList.add("loser")}function Y(){x.value=h;X();I();J()}function V(a){var b=parseInt(x.value,10);b+=parseInt(a,10);x.value=b}window.onload=function(){Y();T()}})();
