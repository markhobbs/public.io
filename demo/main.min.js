(function(){var k=0,l=1,m=5000,n=0,o=2,p=300,q=null,r=!1,s=5,t=[],u=[],v=document.getElementById("container-app-1"),w=document.getElementById("history"),x=document.getElementById("lanes"),y=document.getElementById("message"),z=document.getElementById("selectors"),A=document.getElementById("wallet"),B=document.getElementById("btn-reset-history"),C=document.getElementById("btn-reset"),D=document.getElementById("btn-start"),E=v?v.getElementsByClassName("track"):[],F=[{id:200,color:"#000000",dark:!0,name:"black"},{id:100,color:"#0000ff",dark:!0,name:"blue"},{id:50,color:"#ff0000",dark:!1,name:"red"},{id:20,color:"#ff00ff",dark:!1,name:"magenta"},{id:10,color:"#00ff00",dark:!1,name:"green"},{id:5,color:"#00ffff",dark:!1,name:"cyan"},{id:2,color:"#ffff00",dark:!1,name:"yellow"},{id:1,color:"#d8d8d8",dark:!1,name:"white"}],G={},H={getItem:function(e){try{return window.localStorage.getItem(e)}catch(f){return G[e]||null}},setItem:function(e,f){try{window.localStorage.setItem(e,f)}catch(g){G[e]=f}},removeItem:function(e){try{window.localStorage.removeItem(e)}catch(f){delete G[e]}}};if(!v||!x||!y||!A||!z||!w||!C||!B||!D){alert("Some UI elements are missing. Game cannot load.");return}function I(){var e=[.01,.02,.05,.1,.2,.5,1,2],f=Math.floor(Math.random()*e.length);return e[f]}function J(e){var f=H.getItem("history"),g=f?f+","+e:e;H.setItem("history",g);K()}function K(){var e=H.getItem("history");if(e){B.removeAttribute("disabled");for(var f=e.split(","),g={},h=0;h<f.length;h++){var i=f[h];g[i]=(g[i]||0)+1}w.innerHTML="<pre>"+JSON.stringify(g,null,2)+"</pre>"}else{B.setAttribute("disabled","disabled");w.innerHTML="<p>No Race History As Yet</p>"}}function L(){D.addEventListener("click",O,!1);C.addEventListener("click",N,!1);B.addEventListener("click",M,!1)}function M(){if(confirm("Are You Sure? This Action Will Delete All Race History.")){H.removeItem("history");K()}}function N(){r=!1;q&&clearTimeout(q);y.innerHTML="";var e=parseInt(A.value,10);if(e>0){P();Q()}else alert("Funds Required to Reset Race! Refresh Page to Start Again.")}function O(){r=!0;p=E[0].clientWidth;t=v.querySelectorAll(".lane");window.requestAnimationFrame(R);y.innerHTML="No Bets Please! Race in Progress.";D.setAttribute("disabled","disabled");C.setAttribute("disabled","disabled");z.classList.add("disabled")}function P(){for(var e=0;e<u.length;e++)u[e].classList.remove("active","winner","loser");D.setAttribute("disabled","disabled");C.setAttribute("disabled","disabled");z.classList.remove("disabled")}function Q(){k=0;for(var e=0;e<t.length;e++)t[e].style.width=o+"px",t[e].classList.remove("active")}function R(){if(!r)return;for(var e=-1,f=0;f<t.length;f++){var g=t[f],h=g.offsetWidth,i=o,j=Math.floor(h+i*I());if(h<p)g.style.width=j+"px";else if(e===-1)e=f}i++;if(e>-1){var k=t[e],l=k.getElementsByTagName("span")[0].innerHTML,m=k.getAttribute("id");r=!1;S(m,n,l);J(m)}else window.requestAnimationFrame(R)}function S(e,f,g){var h="<p>Resetting Race in "+s+" seconds.</p>",i="Hooray <strong class='upper'>"+g+"</strong> is the Winner! You Won <strong>"+f+"</strong> Credits.</p>"+h,j="<strong class='upper'>"+g+"</strong> is the Winner! You Lose <strong>"+f+"</strong> Credits.</p>"+h;e===f?(y.innerHTML=i,T(f)):(y.innerHTML=j,T(-f));U(e);C.removeAttribute("disabled");q&&clearTimeout(q);q=setTimeout(N,1e3*s)}function T(e){var f=parseInt(A.value,10);A.value=f+parseInt(e,10)}function U(e){for(var f=0;f<u.length;f++)u[f].name===e?u[f].classList.add("winner"):u[f].classList.add("loser")}function V(){A.value=m;W();K();L()}function W(){for(var e="",f="",g=0;g<F.length;g++){var h=F[g],i=h.dark?"dark":"";e+='<div style="background-color: '+h.color+'" id="'+h.id+'" class="lane '+i+'"><span>'+h.name+"</span></div>";f+='<button style="background-color: '+h.color+'" name="'+h.id+'" class="btn-selector '+i+'">'+h.id+'<sup>c</sup></button>'}x.innerHTML=e;z.innerHTML=f;t=v.querySelectorAll(".lane");u=v.querySelectorAll(".btn-selector");for(var j=0;j<u.length;j++)u[j].addEventListener("click",function(){if(r){alert("No Bets Please! Race in Progress.");return}C.removeAttribute("disabled");if(k<l){var e=document.getElementById(this.name);e.classList.add("active");n=e.getAttribute("id");z.classList.add("disabled");D.removeAttribute("disabled");this.classList.add("active");k++}else alert("Only 1 Bet Per Race! Select Reset to Choose Again.")},!1)}window.onload=function(){V();P()}})();
