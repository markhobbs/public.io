(function(){var g=0,h=1,f=5000,c=0,j=2,k=300,l=null,m=!1,n=5,o=[],p=[],q=document.getElementById("container-app-1"),r=document.getElementById("history"),s=document.getElementById("lanes"),t=document.getElementById("message"),u=document.getElementById("selectors"),v=document.getElementById("wallet"),w=document.getElementById("btn-reset-history"),x=document.getElementById("btn-reset"),y=document.getElementById("btn-start"),z=q?q.getElementsByClassName("track"):[];if(!q||!s||!t||!v||!u||!r||!x||!w||!y){alert("Some UI elements are missing. Game cannot load.");return}var A=[{id:200,color:"#000000",dark:!0,name:"black"},{id:100,color:"#0000ff",dark:!0,name:"blue"},{id:50,color:"#ff0000",dark:!0,name:"red"},{id:20,color:"#ff00ff",dark:!0,name:"magenta"},{id:10,color:"#00ff00",dark:!1,name:"green"},{id:5,color:"#00ffff",dark:!1,name:"cyan"},{id:2,color:"#ffff00",dark:!1,name:"yellow"},{id:1,color:"#d8d8d8",dark:!1,name:"white"}],B={},C={getItem:function(a){try{return window.localStorage.getItem(a)}catch(b){return B[a]||null}},setItem:function(a,b){try{window.localStorage.setItem(a,b)}catch(d){B[a]=b}},removeItem:function(a){try{window.localStorage.removeItem(a)}catch(b){delete B[a]}}},D=function(){var a=[.01,.02,.05,.1,.2,.5,1,2],b=Math.floor(Math.random()*a.length);return a[b]},E=function(a){var b=C.getItem("history"),d=b?b+","+a:a;C.setItem("history",d);F()},F=function(){var a=C.getItem("history");if(a){w.removeAttribute("disabled");for(var b=a.split(","),d={},e=0;e<b.length;e++){var i=b[e];d[i]=(d[i]||0)+1}r.innerHTML="<pre>"+JSON.stringify(d,null,2)+"</pre>"}else{w.setAttribute("disabled","disabled");r.innerHTML="<p>No Race History As Yet</p>"}},G=function(){y.addEventListener("click",L,!1);x.addEventListener("click",K,!1);w.addEventListener("click",I,!1)},H=function(){for(var a=0;a<p.length;a++)p[a].addEventListener("click",J,!1)},M=function(){if(!m)return;for(var a=-1,b=0;b<o.length;b++){var d=o[b],e=d.offsetWidth,i=Math.floor(e+j*D());if(e<k)d.style.width=i+"px";else-1===a&&(a=b)}j++;if(a>-1){var f=o[a],l=f.getElementsByTagName("span")[0].innerHTML,h=f.getAttribute("id");m=!1;N(h,c,l);E(h)}else window.requestAnimationFrame(M)},O=function(){u.classList.add("disabled");y.removeAttribute("disabled")},P=function(){for(var a=0;a<p.length;a++)p[a].classList.remove("active","winner","loser");y.setAttribute("disabled","disabled");x.setAttribute("disabled","disabled");u.classList.remove("disabled")},Q=function(){g=0;for(var a=0;a<o.length;a++)o[a].style.width=j+"px",o[a].classList.remove("active")},I=function(){if(confirm("Are You Sure? This Action Will Delete All Race History.")){C.removeItem("history");F()}},N=function(a,b,d){var e="<p>Resetting Race in "+n+" seconds.</p>",i="Hooray <strong class='upper'>"+d+"</strong> is the Winner! You Won <strong>"+b+"</strong> Credits.</p>"+e,f="<strong class='upper'>"+d+"</strong> is the Winner! You Lose <strong>"+b+"</strong> Credits.</p>"+e;a===b?(t.innerHTML=i,S(b)):(t.innerHTML=f,S(-b));R(a);x.removeAttribute("disabled");l&&clearTimeout(l);l=setTimeout(K,1e3*n)},J=function(e){if(m){alert("No Bets Please! Race in Progress.");return}x.removeAttribute("disabled");if(g<h){var a=document.getElementById(this.name);a.classList.add("active");c=a.getAttribute("id");O();this.classList.add("active");g++}else alert("Only 1 Bet Per Race! Select Reset to Choose Again.")},K=function(){m=!1;l&&clearTimeout(l);t.innerHTML="";var a=parseInt(v.value,10);0<a?(P(),Q()):alert("Funds Required to Reset Race! Refresh Page to Start Again.")},L=function(){m=!0;j=2;k=z[0].clientWidth;o=q.querySelectorAll(".lane");window.requestAnimationFrame(M);t.innerHTML="No Bets Please! Race in Progress.";y.setAttribute("disabled","disabled");x.setAttribute("disabled","disabled");u.classList.add("disabled")},T=function(){for(var a="",b="",d=0;d<A.length;d++){var e=A[d],i=e.dark?"dark":"";a+='<div style="background-color: '+e.color+'" id="'+e.id+'" class="lane '+i+'"><span>'+e.name+"</span></div>";b+='<button style="background-color: '+e.color+'" name="'+e.id+'" class="btn-selector '+i+'">'+e.id+"<sup>c</sup></button>"}s.innerHTML=a;u.innerHTML=b;o=q.querySelectorAll(".lane");p=q.querySelectorAll(".btn-selector");H()},R=function(a){for(var b=0;b<p.length;b++)p[b].name===a?p[b].classList.add("winner"):p[b].classList.add("loser")},U=function(){v.value=f;T();F();G()},S=function(a){var b=parseInt(v.value,10);b+=parseInt(a,10);v.value=b};window.onload=function(){U();P()}})();